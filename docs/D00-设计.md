## 要求和目标

+ 设计上的合理性
+ 低端问题可以调包解决，来实现炫酷的效果
+ 数据和设计要非常合理才能拿高分
+ 论文和设计是最重要的，演示只要不拉垮就可以了

## 待完成事项：

+ [ ] 流量统计逻辑
+ [ ] 移动端菜单按钮失灵 bug
## 难点

1. 多端适配
2. 一个命令就能启动项目
3. 数据库链接

## 文章板块设计

1. 返回时需要按照


### 需要优化的问题

1. 返回所有文章时候应该不需要返回具体的数据，不然通讯成本会增加。需要优化接口返回的数据
### 编辑文章页面

1. 应该有保存按钮
2. 然后呢
3. 应该可以保存。确实。
4. 其他呢？需要返回么？可能需要，但是感觉也不是刚需哇。
5. 所以呢


编辑器初始化：

1. 实例化
2. 挂载
3. 内容初始化

事件处理：

1. 保存
   1. 获取内容
      1. 涉及到获取内容的接口
   2. 网络请求保存
   3. 锁死保存按钮
   4. 退出
   5. 解锁保存按钮并做提示

### 文章展示

点击了这个页面后一开始就回显示一些什么东西来让用户能够看到，缓解用户焦虑。首先我们会展示所有的文章。当然，用户也可以搜索，同时，用户也理应可以按照分类来查询文章。

页面应该美观。目前来说为了达到这个目标我们可以使用卡片式设计。但是我们不想为一篇单独的文章再加一个封面，所以最好直接返回一些什么东西出来。这是最好不过的了。

这个卡片应该是这样的：标题，分类，简单的文字介绍，阅读全文按钮。这是理想状态。

那么很简单。如果处于 PC 端那么可以左半边用于显示一些信息，右半边用于显示文章。左半边无法划动，右半边可以自由滑动。

### 左半边：

1. 搜索
2. 分类筛选
3. 时间轴

如果处于移动端那么加入一个悬浮的按钮。这个按钮可以弹出一个选项框用于查找和再分类筛选。就是这样（这个按钮可以安排在2期制作）

可以。

### 右半边：

1. 移动端显示方案
   1. 每行仅显示一个文章
2. 电脑端显示方案
   1. 每行显示两个文章

### 对于卡片：

1. 一个大标题
2. 彩色小分类
3. 简单的文字介绍阅读全文按钮

继续细化一下卡片的外观。

1. 第一行，显示日期和时间
2. 接下来显示标题和内容。尽量让他看上去像是一个略缩版本的文章
3. 超出的文字不显示

接下来就是编码实现了

用户点击了文章之后应该可以跳转到这个文章的页面中来阅读这个文章。

### 接口方面，我们需要一个查询的接口

查询输入: filter 对象，当前加载的最后一篇文章的时间戳
返回: 指定不能是全部。不然也太大了。先返回了一些个，然后怎么着呢，我们提取一下有用的字符串返回就行了。

开始吧。咱先做这个网页端的玩意儿
1. 获取当前客户端类型
2. 按需求渲染

3. 确定展示样式
   1. 移动端样式
   2. 大屏幕展示样式
4. 是否需要分页显示？
   1. 感觉不需要
   2. 做一个自加载的效果
5. 加载流程
   1. 加载分类
   2. 按照分类渲染
   3. 如果需要进一步渲染就继续加载
6. 状态设计
   1. Articles存储当前文章

### 终极时刻：缝合功能

1. 需要传给 sidebar 的值：
   1. 一个函数，用于改变当前搜索文章的框子
   2. 另一个函数，用于改变当前分类的选择
   3. 所有分类
   4. 当在 sideBar 中点击了标签会发生什么？
      1. 如果未被选中
         1. 调用 renderProp
         2. 选中 UI 展示
      2. 如果已经被选中
         1. 调用 renderProp
         2. 选中 UI 展示撤销
      3. 怎么判断是否已经被选中？
         1. 如果内容和文章名称一致就是
   5. 当在 sideBar 中点击了搜索会发生什么
      1. 这个就很简单了
2. 需要传递给文章列表的东西
   1. 文章对象一整个完了呗
3. 本页面的逻辑
   1. 初始化：
      1. 分类置为 空
      2. 搜索置为 空
      3. 时间置为 0
      4. 获得分类
      5. 调用加载函数获得所有文章
   2. 加载函数
      1. 负责加载复合筛选条件的数据
      2. 筛选条件
         1. 当前文章的最大的时间戳，要选择的必须比这个大
         2. 当前搜索关键词
         3. 分类信息
      3. 返回后将值付给当前文章列表并且改变最大时间

现在需要创建的全局管控变量是：

1. 当前分类 currentTag
2. 当前搜索 currentSearch
3. 最大时间 maxTime
4. 文章列表 articleCollection
5. 所有分类 tagCollection

## 主页的设计

主页最理想情况下可以编辑。

有几种板块：

1. 个人展示板块
   1. 单例
   2. 数据包括
      1. imageUrl 展示图片链接
      2. TextLink介绍性文字或者链接列表 （存储 ID）
         1. clickable 是否可以点击
         2. fontSize 字体大小
         3. content 文字内容
         4. linkTarget 链接地址
         5. comment 备注
      3. IconLink 图标列表（存储 ID）
         1. icon 图标
         2. linkTarget 链接地址
         3. 备注
2. 内容展示板块
   1. 可复用
   2. 数据包括
      1. 展示图片
      2. 介绍性文字或链接列表（同 1-2-2）
3. 尾页
   1. 单例
   2. 数据包括
      1. 背景图片
      2. 最近文章
         1. 文章 ID
         2. 文章标题
      3. 其他链接（同 1-2-2）
      4. 备案管理和别的东西

### 方案再设计

1. 数据表 Page
   1. _id: 唯一标识
   2. imageUrl: 图片链接
   3. name: 页面名称
   4. sort: 排序值
   5. type: 类型，可选： indexPage，contentPage，footerPage。其中 indexPage 和 contentPage 是唯一的。不可以通过外部接口新建。初始化的时候自动新建一个
   6. textLinkList: 文字链接列表
   7. iconLinkList: 图标链接列表

对 Page 数据表的查询

1. 首页/尾页：只返回唯一的一个就可以了
2. 内容页： 返回所有内容页

## 首页前端展示方案

1. 首先获得要展示的素材
2. 对于需要展示的素材进行展示
3. 移动端和电脑端口进行区分

## 加载流程

显示需要 ReactFullPage 组件加载完毕
ReactFullPage 组件需要直接接受数据
数据需要被 map 折叠并渲染
数据需要加载

1. 请求服务数据
2. 获得数据并解析
3. 将解析的数据张开
4. 加载到 ReactFullPage
5. loading false

### 内容页面编辑

1. 需要新建条目
2. 条目可以删除
3. 条目具备: 页面名称，排序值，删除
4. 点击条目进入编辑页面。可以进行增删查改

### 尾页编辑

1. 尾页可以添加链接
2. 尾页可以配置脚注
3. 尾页可以排职图片
4. 


#### 对于首页操作

只对 type 为 indexPage 的数据项进行操作

#### 对于内容页操作：

对 type 为 contentPage 的数据项进行操作

#### 对于尾页操作

对 type 为 footerPage 的数据项进行操作

#### 通用操作流程

1. 添加

### 首页的操作流程

1. 进行首页的加载,读取数据并渲染 （这个是 open 下的）
2. 编辑首页 （这个是 admin 下的）
   1. 因为是单例模式，所以只需要修改就好了
   2. PUT
      1. imageURL
      2. [ { xxx }, ...]
3. 创建文字链接
   1. 发送表单，请求返回值
   2. 当更改时本地先存储更改
4. 保存有两种不同的策略
   1. 策略1:
      1. 将所有的数据一把提交上去然后在服务端完成更改
      2. 分析
         1. 优点
            1. 不用控制异步策略
         2. 缺点
            1. 可复用性可能略低
   2. 策略2
      1. 先保存文字链接数据
      2. 保存成果后再将这些文字链接数据保存到主页数据中
      3. 然后提交主页数据表
      4. 返回是否成功


## 黑板与留言评论功能

### 数据表设计

1. _id: 评论 ID
2. content: 评论内容
3. created: 时间
4. parentId: 父评论 ID
5. ownerArticleId: 评论归属文章 ID
6. commentatorName
7. commentatorEmail
8. commentatorHomepage
9. commentator:
   1. _id: ID
   2. name: 评论者姓名
   3. email: 评论者邮箱
   4. homepage: 评论者主页

### 接口设计

1. POST: 发表
   1. 前端携带的字段
      1. content
      2. parentId
      3. ownerArticleId
      4. commentatorName
      5. commentatorEmail
      6. commentatorHomepage
   2. 后端负责的字段
      1. created
      2. _id: 自动计算
   3. 流程
      1. 接受请求
      2. 查找是否有用户对象
      3. 如果有，记住这个用户
      4. 如果没有，则新建一个用户
      5. 把这个用户搞进去
      6. 存储该记录
      7. 返回成功

2. GET: 返回数据
   1. 输入:
      1. ownerArticle
      2. ID
      3. created
   2. 输出:
      1. \[Comment\]
   3. 流程

3. DELETE: 删除(/admin)
   1. 前端携带的字段
      1. _id

4. PUT: 修改(不急/admin)

### 视图设计

0. 需求
   1. 将评论和留言两个功能作为同一个模块进行开发
   2. 视图上不需要对移动端和桌面端进行区分
1. 模块划分
   1. 评论这个整体（向其中传入 ownerArticle）
      1. 评论发布
         1. 发布 (commentatorName)
      2. 评论列表
         1. 展示
         2. 评论展示


## 邮件提醒功能

## 评论功能

## 分片加载机制

## 图片功能

## 论文实现部分

+ 多端适配能力
+ 管理系统
+ 文章管理展示
+ 编辑与预览展示
+ 主页管理展示
+ 留言管理与评论管理实现

## 论文有待增加的·

1. 用例描述1h
2. 活动流图和业务流程描述1h
3. 数据流图并分析出模块1h
4. 详细设计2h ？
5. 测试1h

## 论文展望与总结

1. 已知问题和解决方案


## 数据流图

1. 命名准确
2. 由
   1. 文档（数据存储点）双划线
   2. 外部项（动作发出者）方框
   3. 加工（处理）圆圈
   4. 数据流（数据）箭头
3. 注重数据的流动，而非控制
4. 每个加工至少有一个输入和输出
5. 用带名字的箭头表示数据的流动，用带名称的圆圈代表加工。
6. 加工的编号应该规范，可以得出其来源
7. 父图应与子图平衡
8. 子图对父图进行分解
9.  数据字典可以解释分解
10. 父图分解为子图的过程中分解了
   1.  加工
   2.  数据流

## 论文最新修改意见：

1. 新增测试章节。学习编写测试
2. 新增类图和说明。
3. 新增健壮图和说明。
4. 增加序列图

5. 进入下一阶段

6. 检查错别字
7. 调整图片标号

8. 进入下一阶段

9. 介绍脚本的实现：启动前进行...
10. 介绍打包器的实现：根据环境进行打包...
11. 介绍开发者体验：进度条、欢迎文字、模块分析器等...

