(self.webpackChunkblog=self.webpackChunkblog||[]).push([[671],{6301:(e,t,n)=>{"use strict";n(9422),n(2917),n(160)},2293:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var o=n(7294),r=n(6661);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function m(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}var s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(d,e);var t,n,c,s,f=(c=d,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=u(c);if(s){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function d(){return a(this,d),f.apply(this,arguments)}return t=d,(n=[{key:"render",value:function(){return o.createElement("div",null,o.createElement(r.Z,{ownerArticleId:-1}))}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),d}(o.Component)},6661:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_});var o=n(7294),r=n(8216),c=n(3728),a=n.n(c),i=(n(160),n(1577)),l=(n(6301),n(6783)),m=(n(9550),n(5203)),u=(n(7700),n(1990)),s=(n(2201),n(8453)),f=(n(6669),n(5026)),d=(n(6583),n(1011)),p=n(4562),y=n.n(p),b=n(1876);function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c=[],a=!0,i=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(c.push(o.value),!t||c.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(i)throw r}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var h=d.Z.TextArea;function C(e){var t=v((0,o.useState)(""),2),n=t[0],r=t[1],c=v((0,o.useState)("Someone"),2),a=c[0],i=c[1],p=v((0,o.useState)(""),2),g=p[0],h=p[1],C=v((0,o.useState)(""),2),w=C[0],E=C[1],I=v((0,o.useState)("Someone"),2),A=I[0],Z=I[1],L=v((0,o.useState)(""),2),_=L[0],j=L[1],k=v((0,o.useState)(""),2),O=k[0],M=k[1],x=v((0,o.useState)(!1),2),P=x[0],R=x[1],N=v((0,o.useState)(!1),2),T=N[0],U=N[1];return o.createElement("div",{className:y().container},o.createElement(u.Z,{avatar:o.createElement(s.C,{size:64,onClick:function(){console.log("avatar Clicked"),j(g),Z(a),M(w),U(!0)}},a),content:o.createElement(S,{onChange:function(e){console.log("handleChange"),r(e.target.value)},onSubmit:function(){R(!0);var t={commentatorName:a,commentatorEmail:g,commentatorHomePage:w,commentValue:n,ownerArticleId:e.ownerArticleId};void 0!==e.parentId&&(console.log("in submit, parentId not undefined"),t.parentId=e.parentId),console.log("handleSubmit",t),b.Z.post("/open/comment",t).then((function(t){console.log(t.data),R(!1),e.getCommentListFunc(),f.ZP.success("留言发表成功"),r("")}))},submitting:P,value:n})}),o.createElement(l.Z,{title:"个人信息",visible:T,okText:"确认",cancelText:"取消",onOk:function(){console.log("modalOkClicked"),h(_),i(A),E(O),U(!1)},onCancel:function(){console.log("modalCancelClicked"),U(!1)}},o.createElement(m.Z,{labelCol:{span:5}},o.createElement(m.Z.Item,{label:"昵称"},o.createElement(d.Z,{defaultValue:A,onChange:function(e){return Z(e.target.value)}})),o.createElement(m.Z.Item,{label:"邮箱"},o.createElement(d.Z,{defaultValue:_,onChange:function(e){return j(e.target.value)}})),o.createElement(m.Z.Item,{label:"主页"},o.createElement(d.Z,{defaultValue:O,onChange:function(e){return M(e.target.value)}})))))}var S=function(e){var t=e.onChange,n=e.onSubmit,r=e.submitting,c=e.value;return o.createElement(o.Fragment,null,o.createElement(m.Z.Item,null,o.createElement(h,{autoSize:{minRows:4,maxRows:6},onChange:t,value:c})),o.createElement(m.Z.Item,null,o.createElement(i.Z,{htmlType:"submit",loading:r,onClick:n,type:"primary"},"发表")))},w=n(3797),E=n.n(w);function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c=[],a=!0,i=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(c.push(o.value),!t||c.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(i)throw r}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Z(e){var t=(0,r.v9)((function(e){return e.window.deviceType})),n=I((0,o.useState)(!1),2),c=n[0],a=n[1],i=I((0,o.useState)(null),2),l=i[0],m=i[1];return(0,o.useEffect)((function(){console.log("in CommentItem",e),void 0!==e.comment.parentId&&(console.log("parentId not undefined, comment:",e.comment),b.Z.get("/open/comment",{params:{_id:e.comment.parentId}}).then((function(e){console.log("parent comment found:",e),m(e.data[0])})))}),[]),o.createElement("div",{className:"client"===t?E().container:E().containerMobile},o.createElement(u.Z,{id:E().commentContainer,avatar:o.createElement(s.C,{size:50},e.comment.commentatorName),content:o.createElement("div",{className:E().commentContent},null!==l?o.createElement("div",{className:E().reference}," @ ",l.commentatorName," : ",l.content):null,o.createElement("div",{className:E().commentContentBox},e.comment.content))}),o.createElement("a",{className:E().reply,onClick:function(){console.log("replyClicked"),a(!c)}},"回复"),c?o.createElement(C,{ownerArticleId:e.ownerArticleId,getCommentListFunc:e.getCommentListFunc,parentId:e.comment._id}):null)}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function _(e){var t,n,c=(0,r.v9)((function(e){return e.window.deviceType})),i=(t=(0,o.useState)([]),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c=[],a=!0,i=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(c.push(o.value),!t||c.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(i)throw r}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=i[0],m=i[1];function u(){console.log("getCommentList called"),b.Z.get("/open/comment",{params:{ownerArticleId:e.ownerArticleId}}).then((function(e){console.log("getCommentList response:",e);var t=e.data;m(t)}))}return(0,o.useEffect)((function(){u()}),[]),o.createElement("div",{className:a().container},o.createElement("div",{className:a().containerSubmit},o.createElement("div",{className:"client"===c?a().submitContainer:a().submitContainerMobile},o.createElement("div",{className:"client"===c?a().commentContainer:a().commentContainerMobile},o.createElement(C,{ownerArticleId:e.ownerArticleId,getCommentListFunc:u})))),o.createElement("div",{className:a().commentList},l.map((function(t){return o.createElement(Z,{key:t._id,ownerArticleId:e.ownerArticleId,getCommentListFunc:u,comment:t})}))))}},1876:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f}),n(6669);var o=n(5026),r=n(9669),c=n.n(r),a=n(8237),i=n.n(a),l=n(9047),m=n(4628),u={baseURL:i().server.prodURL+":"+String(i().server.apiPort),timeout:"8000"},s=c().create({baseURL:u.baseURL,timeout:u.timeout});s.interceptors.request.use((function(e){return e.headers.authToken=l.Z.getState().adminLogin.token,e.headers.username=l.Z.getState().adminLogin.username,e}),(function(e){console.log("[herald] request failed:",e)})),s.interceptors.response.use((function(e){return 0!==e.data.code?(o.ZP.warning(e.data.message),1===e.data.code?o.ZP.error(e.data.message):2===e.data.code|3===e.data.code&&l.Z.dispatch((0,m.av)({username:"",needLogin:!0,token:""})),Promise.reject(e.data.message)):e.data}),(function(e){return console.log("[herald] response failed:",e),Promise.reject(e)}));const f=s},3728:(e,t,n)=>{e.exports={container:"client-components-comment-Comment_container-AXFW",containerSubmit:"client-components-comment-Comment_containerSubmit-GJBj",submitContainer:"client-components-comment-Comment_submitContainer-H9kI",submitContainerMobile:"client-components-comment-Comment_submitContainerMobile-sCu7",commentContainer:"client-components-comment-Comment_commentContainer-mRLS",commentContainerMobile:"client-components-comment-Comment_commentContainerMobile-HMWU",commentList:"client-components-comment-Comment_commentList-XbZd"};var o=n(4783)(e.id,{esModule:!1,locals:!0});e.hot.dispose(o)},3797:(e,t,n)=>{e.exports={container:"client-components-comment-commentList-CommentItem_container-SuHk",containerMobile:"client-components-comment-commentList-CommentItem_containerMobile-QDVi",commentContainer:"client-components-comment-commentList-CommentItem_commentContainer-Z2TU",commentContent:"client-components-comment-commentList-CommentItem_commentContent-MSvC",reference:"client-components-comment-commentList-CommentItem_reference-wXvh",commentContentBox:"client-components-comment-commentList-CommentItem_commentContentBox-tR3R",reply:"client-components-comment-commentList-CommentItem_reply-nxwh"};var o=n(4783)(e.id,{esModule:!1,locals:!0});e.hot.dispose(o)},4562:(e,t,n)=>{e.exports={};var o=n(4783)(e.id,{esModule:!1,locals:!0});e.hot.dispose(o)},2917:(e,t,n)=>{var o=n(4783)(e.id,{esModule:!1,locals:!1});e.hot.dispose(o),e.hot.accept(void 0,o)}}]);