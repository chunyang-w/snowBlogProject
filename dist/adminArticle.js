(self.webpackChunkblog=self.webpackChunkblog||[]).push([[734],{2445:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>S}),n(160);var r=n(1577),o=(n(6669),n(0)),i=n(7294),a=n(6974),l=n(8905),c=n.n(l),s=n(2104),u=n(1876),d=n(6095),m=n.n(d),f=m().import("formats/code-block");f.className="hljs",m().register(f,!0);const p=m();var g=n(7969),h=n.n(g),v=n(2145),y=n(8783);function E(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){E(i,r,o,a,l,"next",e)}function l(e){E(i,r,o,a,l,"throw",e)}a(void 0)}))}}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){l=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function S(){var e=(0,a.UO)(),t=w((0,i.useState)({}),2),n=t[0],l=t[1],u=w((0,i.useState)(),2),d=u[0],m=u[1],f=w((0,i.useState)(),2),g=f[0],h=f[1];return(0,i.useEffect)(b(regeneratorRuntime.mark((function t(){var n,r,o,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("all formats",p.imports),i=e.articleId,h(i),console.log("articleId:",i),o=new p("#admin-editor-content",k),console.log("QuillEditor created:",o),t.next=8,x(i);case 8:n=t.sent,r=n.data,l(r),console.log("Editor Context:",r),""!==r.content&&(console.log("parsing:",r.content),a=JSON.parse(r.content),console.log("setting content",a),o.setContents(a)),m(o);case 14:case"end":return t.stop()}}),t)}))),[]),i.createElement("div",{className:c().container},i.createElement("div",{className:c().header},i.createElement("div",{className:c().left},i.createElement("h1",null," ",n.articleTitle," ")),i.createElement("div",{className:c().right},i.createElement(r.Z,{icon:i.createElement(s.Z,null),onClick:function(){var e=d.getContents(),t=d.getText();console.log("content got:",e,t,g),function(e,t,n){return N.apply(this,arguments)}(g,JSON.stringify(e),t).then((function(){o.ZP.success("保存成功")}))}}))),i.createElement("div",{className:c().editor},i.createElement("div",{id:"admin-editor-toolbar",className:c().toolbar}),i.createElement("div",{id:"admin-editor-content",className:c().content})))}p.register("modules/imageResize",h()),p.register("modules/imageUploader",v.Z);var k={modules:{syntax:{highlight:function(e){return console.log("****",e),y.Z.highlightAuto(e).value}},toolbar:[[{font:[]}],[{header:[1,2,3,4,!1]}],["bold","italic","underline"],["image","code-block"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}],[{align:[]}],["clean"]],imageResize:{modules:["Resize","DisplaySize"]},imageUploader:{upload:function(e){return new Promise((function(t,n){var r=new FormData;r.append("image",e),u.Z.post("/admin/asset",r,{params:{type:"articleImage"}}).then((function(e){console.log(e),0!==e.code?n(e.message):t(e.data.url)}))}))}}},scrollingContainer:".ql-editor",theme:"snow"};function x(e){return I.apply(this,arguments)}function I(){return(I=b(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("in getArticle, articleId",t),e.abrupt("return",u.Z.get("/admin/articleEdit",{params:{articleId:t}}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=b(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(r.length<200?r:r.slice(0,200)).replace(/\n/g," "),e.abrupt("return",u.Z.put("admin/article",{articleId:t,content:n,lastModified:(new Date).getTime(),summary:o}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},8905:e=>{e.exports={container:"client-components-admin-article-articleEditor-ArticleEditor_container-dKIu",header:"client-components-admin-article-articleEditor-ArticleEditor_header-VS9M",left:"client-components-admin-article-articleEditor-ArticleEditor_left-w3bW",right:"client-components-admin-article-articleEditor-ArticleEditor_right-vyD1",editor:"client-components-admin-article-articleEditor-ArticleEditor_editor-qq3X",toolbar:"client-components-admin-article-articleEditor-ArticleEditor_toolbar-z3MC",content:"client-components-admin-article-articleEditor-ArticleEditor_content-JZa8"}}}]);