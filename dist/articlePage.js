(self.webpackChunkblog=self.webpackChunkblog||[]).push([[227],{1574:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>h});var o=n(7294),r=n(8216),a=n(6974),c=n(3977),i=n.n(c),l=n(6095),m=n.n(l),s=n(1876),u=n(8783),d=n(6661),f=n(9442),p=n.n(f);function g(e){return o.createElement("div",{class:p().container},o.createElement("p",{class:p().infoFont},"最后编辑与「",new Date(e.lastModified).toLocaleDateString(),"」 点击量: 「",e.hits,"」"))}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(o=n.next()).done)&&(a.push(o.value),!t||a.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw r}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function h(){var e=(0,r.v9)((function(e){return e.window.deviceType})),t=(0,a.UO)().articleId,n=v((0,o.useState)(null),2),c=n[0],l=n[1],f=v((0,o.useState)(),2),p=(f[0],f[1]),y=v((0,o.useState)({}),2),h=y[0],C=y[1];return(0,o.useEffect)((function(){document.querySelectorAll("pre").forEach((function(e){u.Z.highlightElement(e)}))}),[c]),(0,o.useEffect)((function(){(function(e){return console.log("in getArticle, articleId",e),s.Z.get("/open/articleContent",{params:{articleId:e}})})(t).then((function(e){console.log("content got:",e.data[0].content,{res:e.data[0]}),C(e.data[0]);var t=new(m())("#open-editor-content",b);console.log("editorInstance, content:",t,JSON.parse(e.data[0].content)),t.setContents(JSON.parse(e.data[0].content)),p(t),l(e.data[0].content)})),function(e){console.log("adding hits...",{articleId:e}),s.Z.put("/open/hits",{articleId:e}).then((function(e){console.log("response from hits",e.data)}))}(t)}),[]),o.createElement("div",{className:i().container},o.createElement("div",{className:i().header},o.createElement(g,{hits:h.hits,lastModified:h.lastModified})),o.createElement("div",{className:i().editor},o.createElement("div",{className:"client"===e?i().contentWrapperClient:i().contentWrapperMobile},o.createElement("div",{id:"open-editor-content",className:i().content,style:{border:0}}))),o.createElement(d.Z,{ownerArticleId:t.toString()}))}var b={modules:{toolbar:!1},readOnly:!0,scrollingContainer:".ql-editor",theme:"snow"}},6661:(e,t,n)=>{"use strict";n.d(t,{Z:()=>M});var o=n(7294),r=n(8216),a=n(3728),c=n.n(a),i=(n(160),n(1577)),l=(n(6301),n(6783)),m=(n(9550),n(5203)),s=(n(7700),n(1990)),u=(n(2201),n(8453)),d=(n(6669),n(5026)),f=(n(6583),n(1011)),p=n(4562),g=n.n(p),v=n(1876);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(o=n.next()).done)&&(a.push(o.value),!t||a.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw r}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var b=f.Z.TextArea;function C(e){var t=y((0,o.useState)(""),2),n=t[0],r=t[1],a=y((0,o.useState)("Someone"),2),c=a[0],i=a[1],p=y((0,o.useState)(""),2),h=p[0],b=p[1],C=y((0,o.useState)(""),2),S=C[0],E=C[1],A=y((0,o.useState)("Someone"),2),w=A[0],Z=A[1],L=y((0,o.useState)(""),2),M=L[0],_=L[1],k=y((0,o.useState)(""),2),N=k[0],P=k[1],x=y((0,o.useState)(!1),2),j=x[0],O=x[1],T=y((0,o.useState)(!1),2),U=T[0],F=T[1];return o.createElement("div",{className:g().container},o.createElement(s.Z,{avatar:o.createElement(u.C,{size:64,onClick:function(){console.log("avatar Clicked"),_(h),Z(c),P(S),F(!0)}},c),content:o.createElement(I,{onChange:function(e){console.log("handleChange"),r(e.target.value)},onSubmit:function(){O(!0);var t={commentatorName:c,commentatorEmail:h,commentatorHomePage:S,commentValue:n,ownerArticleId:e.ownerArticleId};void 0!==e.parentId&&(console.log("in submit, parentId not undefined"),t.parentId=e.parentId),console.log("handleSubmit",t),v.Z.post("/open/comment",t).then((function(t){console.log(t.data),O(!1),e.getCommentListFunc(),d.ZP.success("留言发表成功"),r("")}))},submitting:j,value:n})}),o.createElement(l.Z,{title:"个人信息",visible:U,okText:"确认",cancelText:"取消",onOk:function(){console.log("modalOkClicked"),b(M),i(w),E(N),F(!1)},onCancel:function(){console.log("modalCancelClicked"),F(!1)}},o.createElement(m.Z,{labelCol:{span:5}},o.createElement(m.Z.Item,{label:"昵称"},o.createElement(f.Z,{defaultValue:w,onChange:function(e){return Z(e.target.value)}})),o.createElement(m.Z.Item,{label:"邮箱"},o.createElement(f.Z,{defaultValue:M,onChange:function(e){return _(e.target.value)}})),o.createElement(m.Z.Item,{label:"主页"},o.createElement(f.Z,{defaultValue:N,onChange:function(e){return P(e.target.value)}})))))}var I=function(e){var t=e.onChange,n=e.onSubmit,r=e.submitting,a=e.value;return o.createElement(o.Fragment,null,o.createElement(m.Z.Item,null,o.createElement(b,{autoSize:{minRows:4,maxRows:6},onChange:t,value:a})),o.createElement(m.Z.Item,null,o.createElement(i.Z,{htmlType:"submit",loading:r,onClick:n,type:"primary"},"发表")))},S=n(3797),E=n.n(S);function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(o=n.next()).done)&&(a.push(o.value),!t||a.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw r}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Z(e){var t=(0,r.v9)((function(e){return e.window.deviceType})),n=A((0,o.useState)(!1),2),a=n[0],c=n[1],i=A((0,o.useState)(null),2),l=i[0],m=i[1];return(0,o.useEffect)((function(){console.log("in CommentItem",e),void 0!==e.comment.parentId&&(console.log("parentId not undefined, comment:",e.comment),v.Z.get("/open/comment",{params:{_id:e.comment.parentId}}).then((function(e){console.log("parent comment found:",e),m(e.data[0])})))}),[]),o.createElement("div",{className:"client"===t?E().container:E().containerMobile},o.createElement(s.Z,{id:E().commentContainer,avatar:o.createElement(u.C,{size:50},e.comment.commentatorName),content:o.createElement("div",{className:E().commentContent},null!==l?o.createElement("div",{className:E().reference}," @ ",l.commentatorName," : ",l.content):null,o.createElement("div",{className:E().commentContentBox},e.comment.content))}),o.createElement("a",{className:E().reply,onClick:function(){console.log("replyClicked"),c(!a)}},"回复"),a?o.createElement(C,{ownerArticleId:e.ownerArticleId,getCommentListFunc:e.getCommentListFunc,parentId:e.comment._id}):null)}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function M(e){var t,n,a=(0,r.v9)((function(e){return e.window.deviceType})),i=(t=(0,o.useState)([]),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(o=n.next()).done)&&(a.push(o.value),!t||a.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw r}}return a}}(t,n)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=i[0],m=i[1];function s(){console.log("getCommentList called"),v.Z.get("/open/comment",{params:{ownerArticleId:e.ownerArticleId}}).then((function(e){console.log("getCommentList response:",e);var t=e.data;m(t)}))}return(0,o.useEffect)((function(){s()}),[]),o.createElement("div",{className:c().container},o.createElement("div",{className:c().containerSubmit},o.createElement("div",{className:"client"===a?c().submitContainer:c().submitContainerMobile},o.createElement("div",{className:"client"===a?c().commentContainer:c().commentContainerMobile},o.createElement(C,{ownerArticleId:e.ownerArticleId,getCommentListFunc:s})))),o.createElement("div",{className:c().commentList},l.map((function(t){return o.createElement(Z,{key:t._id,ownerArticleId:e.ownerArticleId,getCommentListFunc:s,comment:t})}))))}},1876:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d}),n(6669);var o=n(5026),r=n(9669),a=n.n(r),c=n(8237),i=n.n(c),l=n(9047),m=n(4628),s={baseURL:i().server.prodURL+":"+String(i().server.apiPort),timeout:"8000"},u=a().create({baseURL:s.baseURL,timeout:s.timeout});u.interceptors.request.use((function(e){return e.headers.authToken=l.Z.getState().adminLogin.token,e.headers.username=l.Z.getState().adminLogin.username,e}),(function(e){console.log("[herald] request failed:",e)})),u.interceptors.response.use((function(e){return 0!==e.data.code?(o.ZP.warning(e.data.message),1===e.data.code?o.ZP.error(e.data.message):2===e.data.code|3===e.data.code&&l.Z.dispatch((0,m.av)({username:"",needLogin:!0,token:""})),Promise.reject(e.data.message)):e.data}),(function(e){return console.log("[herald] response failed:",e),Promise.reject(e)}));const d=u},3977:(e,t,n)=>{e.exports={container:"client-components-articlePage-ArticlePage_container-ykjk",header:"client-components-articlePage-ArticlePage_header-cpue",editor:"client-components-articlePage-ArticlePage_editor-c2iI",contentWrapperClient:"client-components-articlePage-ArticlePage_contentWrapperClient-ztsW",contentWrapperMobile:"client-components-articlePage-ArticlePage_contentWrapperMobile-cLsB"};var o=n(4783)(e.id,{esModule:!1,locals:!0});e.hot.dispose(o)},9442:(e,t,n)=>{e.exports={container:"client-components-articlePage-InfoBar-InfoBar_container-RVyz",infoFont:"client-components-articlePage-InfoBar-InfoBar_infoFont-VSzT"};var o=n(4783)(e.id,{esModule:!1,locals:!0});e.hot.dispose(o)},3728:(e,t,n)=>{e.exports={container:"client-components-comment-Comment_container-AXFW",containerSubmit:"client-components-comment-Comment_containerSubmit-GJBj",submitContainer:"client-components-comment-Comment_submitContainer-H9kI",submitContainerMobile:"client-components-comment-Comment_submitContainerMobile-sCu7",commentContainer:"client-components-comment-Comment_commentContainer-mRLS",commentContainerMobile:"client-components-comment-Comment_commentContainerMobile-HMWU",commentList:"client-components-comment-Comment_commentList-XbZd"};var o=n(4783)(e.id,{esModule:!1,locals:!0});e.hot.dispose(o)},3797:(e,t,n)=>{e.exports={container:"client-components-comment-commentList-CommentItem_container-SuHk",containerMobile:"client-components-comment-commentList-CommentItem_containerMobile-QDVi",commentContainer:"client-components-comment-commentList-CommentItem_commentContainer-Z2TU",commentContent:"client-components-comment-commentList-CommentItem_commentContent-MSvC",reference:"client-components-comment-commentList-CommentItem_reference-wXvh",commentContentBox:"client-components-comment-commentList-CommentItem_commentContentBox-tR3R",reply:"client-components-comment-commentList-CommentItem_reply-nxwh"};var o=n(4783)(e.id,{esModule:!1,locals:!0});e.hot.dispose(o)},4562:(e,t,n)=>{e.exports={};var o=n(4783)(e.id,{esModule:!1,locals:!0});e.hot.dispose(o)}}]);